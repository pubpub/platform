---































































































































































































































































































































































































































































































































































































































































































































































































import { getHeader, getJournal, getPages } from "../lib/client/queries"
import { getFieldValue } from "../lib/getValue"

const journal = await getJournal()
const _header = await getHeader()

// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// don't want to use any of this? delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.

const _heroText = getFieldValue<string>(journal, "Hero Text")
const _description = getFieldValue<string>(journal, "Description")
const _publishAs = getFieldValue<string>(journal, "Publish As")
const _publicationDate = getFieldValue<string>(journal, "Publication Date")

const page = await getPages({
	slugs: ["/"],
})

const _layout = getFieldValue<string>(page[0], "Layout")
---

<Layout journal={journal} header={header}>
	<div id="container" class="max-w-6xl mx-auto px-4 py-8">
		<main>
			<section class="mb-12">
				<div class="bg-white p-8 rounded-lg shadow-lg">
					<h1 class="text-4xl font-bold mb-2">
						{journal.title}
					</h1>
					{heroText && <p class="text-xl text-gray-700 mb-6">{heroText}</p>}
					{description && <p class="text-gray-600 mb-8">{description}</p>}
					{publishAs && <p class="text-gray-600 mb-8">Published by: {publishAs}</p>}
					{
						publicationDate && (
							<p class="text-gray-600 mb-8">Publication Date: {publicationDate}</p>
						)
					}

					<div class="text-sm text-gray-500">
						Publication Date: {
							publicationDate
								? new Date(publicationDate).toLocaleDateString("en-US", {
										month: "long",
										day: "numeric",
										year: "numeric",
									})
								: "Unknown"
						}
					</div>
				</div>
			</section>

			<div class="prose">
				<div set:html={layout} />
			</div>

			<section class="mb-8">
				<h2 class="text-2xl font-bold mb-6">Journal Articles</h2>

				<div class="grid gap-6">
					{
						getRelatedPubs(journal, "Journal Articles")
							?.slice(0, 20)
							.map((article) => {
								if (!article) {
									return;
								}
								const slug = getFieldValue(article, "Slug");
								return (
									<div class="bg-white p-6 rounded-lg shadow hover:shadow-md transition-shadow">
										<a href={`/pub/${slug}`} class="block">
											<h3 class="text-xl font-semibold mb-2 text-blue-800 hover:text-blue-600">
												{article.title}
											</h3>
											<div class="flex justify-between items-center">
												<span class="text-sm text-gray-600">
													{new Date(
														article.createdAt ?? new Date()
													).toLocaleDateString("en-US", {
														month: "short",
														day: "numeric",
														year: "numeric",
													})}
												</span>
												<span class="text-sm text-blue-600">
													Read article â†’
												</span>
											</div>
										</a>
									</div>
								);
							})
					}
				</div>
			</section>
		</main>
	</div>
</Layout>
