1:"$Sreact.fragment"
2:I[69342,["/platform/pr-preview/pr-1389/_next/static/chunks/63b34c0935a23979.js","/platform/pr-preview/pr-1389/_next/static/chunks/132b3b507b8f93c0.js","/platform/pr-preview/pr-1389/_next/static/chunks/3947e680289e86bd.js","/platform/pr-preview/pr-1389/_next/static/chunks/e52be8c22c49b96f.js"],"TOCProvider"]
3:I[84868,["/platform/pr-preview/pr-1389/_next/static/chunks/63b34c0935a23979.js","/platform/pr-preview/pr-1389/_next/static/chunks/132b3b507b8f93c0.js","/platform/pr-preview/pr-1389/_next/static/chunks/3947e680289e86bd.js","/platform/pr-preview/pr-1389/_next/static/chunks/e52be8c22c49b96f.js"],"Sidebar"]
4:I[81427,["/platform/pr-preview/pr-1389/_next/static/chunks/63b34c0935a23979.js","/platform/pr-preview/pr-1389/_next/static/chunks/132b3b507b8f93c0.js","/platform/pr-preview/pr-1389/_next/static/chunks/3947e680289e86bd.js","/platform/pr-preview/pr-1389/_next/static/chunks/e52be8c22c49b96f.js"],"ClientWrapper"]
6:I[91962,["/platform/pr-preview/pr-1389/_next/static/chunks/63b34c0935a23979.js","/platform/pr-preview/pr-1389/_next/static/chunks/132b3b507b8f93c0.js","/platform/pr-preview/pr-1389/_next/static/chunks/3947e680289e86bd.js","/platform/pr-preview/pr-1389/_next/static/chunks/e52be8c22c49b96f.js"],"HeadingAnchor"]
8:I[78375,["/platform/pr-preview/pr-1389/_next/static/chunks/fc5c9d213030d4bd.js","/platform/pr-preview/pr-1389/_next/static/chunks/8b6035d3c29e44af.js"],"OutletBoundary"]
9:"$Sreact.suspense"
5:T46c,---
title: "Global Cloudflare configuration"
---

# Global Cloudflare configuration

This module should generally be created by an admin,
and assumees the following permissions which are sensitive:

**Cloudflare read-write token** set at `CLOUDFLARE_API_TOKEN`. In general, this
secret can be used for very nefarious things and should be extra sensitively protected.

**AWS read-write permissions**: in `~/.aws/credentials`. see `../maskfile.md` for more info.

## Relationship to AWS environments

AWS environments assume existence of the Route53 zone and DNS NS records that refer authority
to that zone. If you are not using Cloudflare this module is not needed for those environments,
but in general to create a new env it is expected to augment this module with NS records referring
to this route53 configuration for domains subordinate to that new AWS env.

Therefore updates to this module, which should happen very infrequently, should be applied before
you attempt to create the new AWS-ECS environment, otherwise that will fail due to the AWS Certificate
Manager being unsuccessful in validating your ownership of the DNS.0:{"buildId":"oE2SjR_uDF8vcvjC-Gvxe","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"x:mx-auto x:flex x:max-w-(--nextra-content-width)","children":["$","$L2",null,{"value":[{"value":"Relationship to AWS environments","id":"relationship-to-aws-environments","depth":2}],"children":[["$","$L3",null,{}],["$","$L4",null,{"metadata":{"title":"Global Cloudflare configuration","filePath":"content/infrastructure/environments/cloudflare.mdx","timestamp":1750086553000},"sourceCode":"$5","children":[["$","div",null,{"id":"nextra-skip-nav"}],["$","main",null,{"data-pagefind-body":true,"children":[["$","h1",null,{"className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-bold x:mt-2 x:text-4xl","children":["Global Cloudflare configuration","$undefined"]}],"\n",["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"This module should generally be created by an admin,\nand assumees the following permissions which are sensitive:"}],"\n",["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":[["$","strong",null,{"children":"Cloudflare read-write token"}]," set at ",["$","code",null,{"className":"nextra-code","dir":"ltr","children":"CLOUDFLARE_API_TOKEN"}],". In general, this\nsecret can be used for very nefarious things and should be extra sensitively protected."]}],"\n",["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":[["$","strong",null,{"children":"AWS read-write permissions"}],": in ",["$","code",null,{"className":"nextra-code","dir":"ltr","children":"~/.aws/credentials"}],". see ",["$","code",null,{"className":"nextra-code","dir":"ltr","children":"../maskfile.md"}]," for more info."]}],"\n",["$","h2",null,{"id":"relationship-to-aws-environments","className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-semibold x:target:animate-[fade-in_1.5s] x:mt-10 x:border-b x:pb-1 x:text-3xl nextra-border","children":["Relationship to AWS environments",["$","$L6",null,{"id":"relationship-to-aws-environments"}]]}],"\n",["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"AWS environments assume existence of the Route53 zone and DNS NS records that refer authority\nto that zone. If you are not using Cloudflare this module is not needed for those environments,\nbut in general to create a new env it is expected to augment this module with NS records referring\nto this route53 configuration for domains subordinate to that new AWS env."}],"\n",["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Therefore updates to this module, which should happen very infrequently, should be applied before\nyou attempt to create the new AWS-ECS environment, otherwise that will fail due to the AWS Certificate\nManager being unsuccessful in validating your ownership of the DNS."}]]}]]}]]}]}],null,"$L7"]}],"loading":null,"isPartial":false}
7:["$","$L8",null,{"children":["$","$9",null,{"name":"Next.MetadataOutlet","children":"$@a"}]}]
a:null
